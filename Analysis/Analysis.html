<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cameron J. Anderson, Jamie Ling, Michael Schutz">

<title>Expressive Deadpan Analyses</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Analysis_files/libs/quarto-html/quarto.js"></script>
<script src="Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Expressive Deadpan Analyses</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Cameron J. Anderson, Jamie Ling, Michael Schutz </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="data-set-up" class="level1">
<h1>Data Set-up</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">'/Data/Bootstrap.RData'</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>emoData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">'/Data/Ratings.csv'</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load dependencies &amp; functions, analyses</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">'/R/Libraries.R'</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">'/R/Functions.R'</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">paste0</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">'/R/Preprocessing.R'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="power-analysis" class="level1">
<h1>Power Analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pwrss<span class="sc">::</span><span class="fu">pwrss.f.reg</span>(<span class="at">r2 =</span> <span class="fl">0.4</span>, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">power =</span> .<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Linear Regression (F test) 
 R-squared Deviation from 0 (zero) 
 H0: r2 = 0 
 HA: r2 &gt; 0 
 ------------------------------ 
  Statistical power = 0.9 
  n = 26 
 ------------------------------ 
 Numerator degrees of freedom = 3 
 Denominator degrees of freedom = 21.559 
 Non-centrality parameter = 17.04 
 Type I error rate = 0.05 
 Type II error rate = 0.1 </code></pre>
</div>
</div>
<section id="summarize-valence-and-arousal-ratings-by-piece" class="level3">
<h3 class="anchored" data-anchor-id="summarize-valence-and-arousal-ratings-by-piece">Summarize valence and arousal ratings by piece</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create summary data frame</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fullDat <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(composer, albumID, condition, key) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">arousal =</span> <span class="fu">mean</span>(arousal),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">valence =</span> <span class="fu">mean</span>(valence)) <span class="ot">-&gt;</span> summaryDat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="research-question-1" class="level2">
<h2 class="anchored" data-anchor-id="research-question-1">Research Question 1</h2>
<p><strong>How similar are ratings?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">pairedCircumplex</span>(<span class="fu">subset</span>(fullDat, composer <span class="sc">==</span> <span class="st">'bach'</span>), </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">groupCol =</span> <span class="st">'expID'</span>, <span class="at">chosenLvls =</span> <span class="fu">c</span>(<span class="st">'141'</span>, <span class="st">'142'</span>)) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">'Bach'</span>, <span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">pairedCircumplex</span>(chop, <span class="at">groupCol =</span> <span class="st">'expID'</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">chosenLvls =</span> <span class="fu">c</span>(<span class="st">'101'</span>, <span class="st">'137'</span>)) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">'Chopin'</span>, <span class="at">x =</span> <span class="st">''</span>, <span class="at">y =</span> <span class="st">''</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">get_plot_component</span>(p1, <span class="st">'guide-box-bottom'</span>) <span class="ot">-&gt;</span> circLeg</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(circLeg, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>             p1 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>), </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>             p2 <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">layout_matrix =</span> circLayout,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">bottom =</span> <span class="st">'Valence'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">left =</span> <span class="st">'Arousal'</span>) <span class="co"># %&gt;%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggsave(filename = paste0('Figures/Fig 1-', </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                              Sys.Date(), '.png'),</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  width = 7.5, height = 4.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="do-deadpan-expressive-conditions-significantly-differ-in-terms-of-valence-and-arousal" class="level4">
<h4 class="anchored" data-anchor-id="do-deadpan-expressive-conditions-significantly-differ-in-terms-of-valence-and-arousal">Do deadpan &amp; expressive conditions significantly differ in terms of valence and arousal?</h4>
<p>The mean valence rating of deadpan listeners is 4.17 The SD valence rating of deadpan listeners is 1.62 The mean valence rating of expressive listeners is 4.17 The SD valence rating of expressive listeners is 1.68 The mean arousal rating of deadpan listeners is 60.14 The SD arousal rating of deadpan listeners is 26.56 The mean arousal rating of expressive listeners is 55.25 The SD arousal rating of expressive listeners is 28.6</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test differences (nonparametric)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(valence<span class="sc">~</span><span class="fu">as.factor</span>(condition), <span class="at">data =</span> summaryDat, <span class="at">paired =</span> T, <span class="at">exact =</span> F) <span class="ot">-&gt;</span> t1</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(arousal<span class="sc">~</span><span class="fu">as.factor</span>(condition), <span class="at">data =</span> summaryDat, <span class="at">paired =</span> T, <span class="at">exact =</span> F) <span class="ot">-&gt;</span> t2</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  valence by as.factor(condition)
V = 576, p-value = 0.9031
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  arousal by as.factor(condition)
V = 942.5, p-value = 0.0002825
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">'Adjusted P'</span>, <span class="fu">p.adjust</span>(<span class="fu">c</span>(t1<span class="sc">$</span>p.value, t2<span class="sc">$</span>p.value))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adjusted P 0.903106290500512"    "Adjusted P 0.000564946450863395"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(rcompanion<span class="sc">::</span><span class="fu">wilcoxonPairedR</span>(<span class="at">x =</span> summaryDat<span class="sc">$</span>valence, <span class="at">g =</span> summaryDat<span class="sc">$</span>condition, <span class="at">ci =</span> T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.0185 -0.2730  0.3170</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(rcompanion<span class="sc">::</span><span class="fu">wilcoxonPairedR</span>(<span class="at">x =</span> summaryDat<span class="sc">$</span>arousal, <span class="at">g =</span> summaryDat<span class="sc">$</span>condition, <span class="at">ci =</span> T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.525 0.277 0.723</code></pre>
</div>
</div>
<p><br>
<strong>arousal differs, valence doesn’t</strong></p>
</section>
</section>
<section id="research-question-2" class="level2">
<h2 class="anchored" data-anchor-id="research-question-2">Research Question 2</h2>
<section id="do-these-differences-appear-for-each-composer" class="level4">
<h4 class="anchored" data-anchor-id="do-these-differences-appear-for-each-composer">Do these differences appear for each composer?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chopin comparisons</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(valence<span class="sc">~</span>condition, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'bach'</span>), <span class="at">paired =</span> T, <span class="at">exact =</span>F)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(valence<span class="sc">~</span>condition, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'chopin'</span>), <span class="at">paired =</span> T,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span> F)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">## bach -- arousal significantly differs</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(arousal<span class="sc">~</span>condition, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'bach'</span>), <span class="at">paired =</span> T, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span>F)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>t4<span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(arousal<span class="sc">~</span>condition, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'chopin'</span>), <span class="at">paired =</span> T,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span> F)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  valence by condition
V = 113, p-value = 0.4559
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  valence by condition
V = 176.5, p-value = 0.4574
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  arousal by condition
V = 272, p-value = 0.0005177
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  arousal by condition
V = 201, p-value = 0.1491
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(t1<span class="sc">$</span>p.value, t2<span class="sc">$</span>p.value, t3<span class="sc">$</span>p.value, t4<span class="sc">$</span>p.value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.911768954 0.911768954 0.002070788 0.447182154</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(t1, t2, t3, t4)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>rcompanion<span class="sc">::</span><span class="fu">wilcoxonPairedR</span>(<span class="at">x =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'bach'</span>)<span class="sc">$</span>valence, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">g =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'bach'</span>)<span class="sc">$</span>condition, <span class="at">ci =</span> T) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.159 -0.565  0.259</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>rcompanion<span class="sc">::</span><span class="fu">wilcoxonPairedR</span>(<span class="at">x =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'chopin'</span>)<span class="sc">$</span>valence, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">g =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'chopin'</span>)<span class="sc">$</span>condition, <span class="at">ci =</span> T) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.155 -0.257  0.563</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>rcompanion<span class="sc">::</span><span class="fu">wilcoxonPairedR</span>(<span class="at">x =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'bach'</span>)<span class="sc">$</span>arousal, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">g =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'bach'</span>)<span class="sc">$</span>condition, <span class="at">ci =</span> T) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.712 0.461 0.841</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>rcompanion<span class="sc">::</span><span class="fu">wilcoxonPairedR</span>(<span class="at">x =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'chopin'</span>)<span class="sc">$</span>arousal, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">g =</span> <span class="fu">subset</span>(summaryDat, composer <span class="sc">==</span> <span class="st">'chopin'</span>)<span class="sc">$</span>condition, <span class="at">ci =</span> T) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.298 -0.128  0.665</code></pre>
</div>
</div>
</section>
<section id="which-features-predict-valence-and-arousal-differences" class="level3">
<h3 class="anchored" data-anchor-id="which-features-predict-valence-and-arousal-differences">Which Features Predict Valence and Arousal Differences?</h3>
<p>To assess this, we calculate the percent difference of valence and arousal ratings,</p>
<p><span class="math display">\[
d(x, y) = \frac{|x-y|}{[\frac{(x+y)}{2}]}*100,
\]</span></p>
<p>where <span class="math inline">\(x\)</span> represents ratings in the expressive condition averaged by piece and <span class="math inline">\(y\)</span> represents ratings in the deadpan condition averaged by piece.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first calculate averaged values per piece in each condition</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>expressive <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(composer, key) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">valence =</span> <span class="fu">mean</span>(valence),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">arousal =</span> <span class="fu">mean</span>(arousal),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">arPerf =</span> <span class="fu">mean</span>(arPerf),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">pitchHeight =</span> <span class="fu">mean</span>(pitchHeight),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">rms =</span> <span class="fu">mean</span>(rms),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">mode =</span> <span class="fu">unique</span>(mode)) <span class="ot">-&gt;</span> expressiveRatingsAvg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'composer'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>deadpan <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(composer, key) <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">valence =</span> <span class="fu">mean</span>(valence),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">arousal =</span> <span class="fu">mean</span>(arousal)) <span class="ot">-&gt;</span> deadpanRatingsAvg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'composer'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now calculate percentage difference in ratings:</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg<span class="sc">$</span>valenceDiff <span class="ot">&lt;-</span> <span class="fu">.getPercentDifference</span>(expressiveRatingsAvg<span class="sc">$</span>valence, deadpanRatingsAvg<span class="sc">$</span>valence)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg<span class="sc">$</span>arousalDiff <span class="ot">&lt;-</span> <span class="fu">.getPercentDifference</span>(expressiveRatingsAvg<span class="sc">$</span>arousal, deadpanRatingsAvg<span class="sc">$</span>arousal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(expressiveRatingsAvg<span class="sc">$</span>valenceDiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   2.615   4.964   7.299   9.755  22.951 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(expressiveRatingsAvg<span class="sc">$</span>arousalDiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.1605  4.1255 12.3498 17.0744 24.6988 53.3679 </code></pre>
</div>
</div>
<section id="how-similar-are-valence-and-arousal-ratings" class="level4">
<h4 class="anchored" data-anchor-id="how-similar-are-valence-and-arousal-ratings">How similar are valence and arousal ratings?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall correlations</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="fu">subset</span>(summaryDat, condition <span class="sc">==</span> <span class="st">'expressive'</span>)<span class="sc">$</span>valence, <span class="fu">subset</span>(summaryDat, condition <span class="sc">==</span> <span class="st">'deadpan'</span>)<span class="sc">$</span>valence) <span class="ot">-&gt;</span> t1</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="fu">subset</span>(summaryDat, condition <span class="sc">==</span> <span class="st">'expressive'</span>)<span class="sc">$</span>arousal, <span class="fu">subset</span>(summaryDat, condition <span class="sc">==</span> <span class="st">'deadpan'</span>)<span class="sc">$</span>arousal) <span class="ot">-&gt;</span> t2</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  subset(summaryDat, condition == "expressive")$valence and subset(summaryDat, condition == "deadpan")$valence
t = 22.059, df = 46, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.9221514 0.9751399
sample estimates:
      cor 
0.9558412 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  subset(summaryDat, condition == "expressive")$arousal and subset(summaryDat, condition == "deadpan")$arousal
t = 19.631, df = 46, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.903756 0.969064
sample estimates:
      cor 
0.9451795 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">p.adjust</span>(<span class="fu">c</span>(t1<span class="sc">$</span>p.value, t2<span class="sc">$</span>p.value)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.395871e-26 5.412108e-24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(t1, t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-values-significantly-differ-from-zero" class="level4">
<h4 class="anchored" data-anchor-id="do-values-significantly-differ-from-zero">Do values significantly differ from zero?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(expressiveRatingsAvg<span class="sc">$</span>arousalDiff, <span class="at">exact =</span> F) <span class="ot">-&gt;</span> t1</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(expressiveRatingsAvg<span class="sc">$</span>valenceDiff, <span class="at">exact =</span> F) <span class="ot">-&gt;</span> t2</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  expressiveRatingsAvg$arousalDiff
V = 1176, p-value = 1.684e-09
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  expressiveRatingsAvg$valenceDiff
V = 1128, p-value = 2.475e-09
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">p.adjust</span>(<span class="fu">c</span>(t1<span class="sc">$</span>p.value, t2<span class="sc">$</span>p.value)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.367163e-09 3.367163e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(t1, t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Valence and arousal percent differences significantly differ from 0</strong></p>
<p><strong>Do they differ between major and minor modes?</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(mode) <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanValenceDiff =</span> <span class="fu">mean</span>(valenceDiff), </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">sdValenceDiff=</span><span class="fu">sd</span>(valenceDiff), </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanArousalDiff =</span> <span class="fu">mean</span>(arousalDiff), <span class="at">sdArousalDiff=</span><span class="fu">sd</span>(arousalDiff))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  mode  meanValenceDiff sdValenceDiff meanArousalDiff sdArousalDiff
  &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
1 Major            4.79          3.98            18.0          13.2
2 minor            9.81          6.86            16.1          16.4</code></pre>
</div>
</div>
<p>Do differences between conditions relate to mode?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(expressiveRatingsAvg<span class="sc">$</span>valenceDiff<span class="sc">~</span>expressiveRatingsAvg<span class="sc">$</span>mode,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span> F) <span class="ot">-&gt;</span> t1</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(expressiveRatingsAvg<span class="sc">$</span>arousalDiff<span class="sc">~</span>expressiveRatingsAvg<span class="sc">$</span>mode,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span> F) <span class="ot">-&gt;</span> t2</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  expressiveRatingsAvg$valenceDiff by expressiveRatingsAvg$mode
W = 157, p-value = 0.007124
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  expressiveRatingsAvg$arousalDiff by expressiveRatingsAvg$mode
W = 336, p-value = 0.3274
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">p.adjust</span>(<span class="fu">c</span>(t1<span class="sc">$</span>p.value, t2<span class="sc">$</span>p.value)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01424718 0.32736584</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(t1, t2)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcoxonR</span>(<span class="at">x=</span>expressiveRatingsAvg<span class="sc">$</span>valence,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">g=</span>expressiveRatingsAvg<span class="sc">$</span>mode, <span class="at">ci =</span> T) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.794 0.687 0.844</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcoxonR</span>(<span class="at">x=</span>expressiveRatingsAvg<span class="sc">$</span>arousal,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">g=</span>expressiveRatingsAvg<span class="sc">$</span>mode, <span class="at">ci =</span> T) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.0179 -0.3230  0.2680</code></pre>
</div>
</div>
</section>
<section id="what-cues-predict-differences" class="level4">
<h4 class="anchored" data-anchor-id="what-cues-predict-differences">What cues predict differences?</h4>
<p>First, we examine differences across major and minor pieces:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now valence...</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">percentCorrelationPlot</span>(expressiveRatingsAvg, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> expressiveRatingsAvg<span class="sc">$</span>valenceDiff,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">25</span>),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> expressiveRatingsAvg<span class="sc">$</span>arPerf,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cp1</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="fu">percentCorrelationPlot</span>(expressiveRatingsAvg, </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> expressiveRatingsAvg<span class="sc">$</span>valenceDiff,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">25</span>),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> expressiveRatingsAvg<span class="sc">$</span>rms,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cp2</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="fu">percentCorrelationPlot</span>(expressiveRatingsAvg, </span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> expressiveRatingsAvg<span class="sc">$</span>valenceDiff, </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">25</span>),</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> expressiveRatingsAvg<span class="sc">$</span>pitchHeight,</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>                       <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cp3</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  <span class="do">## OVER AROUSAL</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a><span class="fu">percentCorrelationPlot</span>(expressiveRatingsAvg, </span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> expressiveRatingsAvg<span class="sc">$</span>arousalDiff, </span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> expressiveRatingsAvg<span class="sc">$</span>arPerf,</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xLab =</span> <span class="st">'Attack Rate'</span>,</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cp4</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a><span class="fu">percentCorrelationPlot</span>(expressiveRatingsAvg, </span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> expressiveRatingsAvg<span class="sc">$</span>arousalDiff, </span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> expressiveRatingsAvg<span class="sc">$</span>rms,</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xLab =</span> <span class="st">'RMS Amp.'</span>,</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cp5</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a><span class="fu">percentCorrelationPlot</span>(expressiveRatingsAvg, </span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> expressiveRatingsAvg<span class="sc">$</span>arousalDiff, </span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> expressiveRatingsAvg<span class="sc">$</span>pitchHeight,</span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xLab =</span> <span class="st">'Pitch Height'</span>,</span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cp6</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(percentLegend,</span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a>             cp1, cp2, cp3, cp4, cp5, cp6,</span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a>             <span class="at">left =</span> <span class="st">'Absolute Difference (%)'</span>,</span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># ncol = 3, nrow = 2,</span></span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a>             <span class="at">layout_matrix =</span> pctCorLay) <span class="ot">-&gt;</span> cuePercentPlot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  ggsave(filename = paste0('Figures/Fig 2-', Sys.Date(), '.png'),</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#         plot = cuePercentPlot,</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#         width = 7.5, height = 4.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>diffsMaj <span class="ot">&lt;-</span> <span class="fu">subset</span>(expressiveRatingsAvg, mode <span class="sc">==</span> <span class="st">'Major'</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>diffsMin <span class="ot">&lt;-</span> <span class="fu">subset</span>(expressiveRatingsAvg, mode <span class="sc">==</span> <span class="st">'minor'</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMin<span class="sc">$</span>arPerf, diffsMin<span class="sc">$</span>valenceDiff) <span class="ot">-&gt;</span> t1</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMaj<span class="sc">$</span>arPerf, diffsMaj<span class="sc">$</span>valenceDiff) <span class="ot">-&gt;</span> t2</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMin<span class="sc">$</span>rms, diffsMin<span class="sc">$</span>valenceDiff) <span class="ot">-&gt;</span> t3</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMaj<span class="sc">$</span>rms, diffsMaj<span class="sc">$</span>valenceDiff) <span class="ot">-&gt;</span> t4</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMin<span class="sc">$</span>pitchHeight, diffsMin<span class="sc">$</span>valenceDiff) <span class="ot">-&gt;</span> t5</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMaj<span class="sc">$</span>pitchHeight, diffsMaj<span class="sc">$</span>valenceDiff) <span class="ot">-&gt;</span> t6</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMin$arPerf and diffsMin$valenceDiff
t = 2.2906, df = 22, p-value = 0.03194
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.0430442 0.7155517
sample estimates:
      cor 
0.4388213 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMaj$arPerf and diffsMaj$valenceDiff
t = -3.0323, df = 22, p-value = 0.006119
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.7762915 -0.1786339
sample estimates:
       cor 
-0.5429084 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMin$rms and diffsMin$valenceDiff
t = 2.1183, df = 22, p-value = 0.04568
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.009828117 0.698940886
sample estimates:
     cor 
0.411593 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMaj$rms and diffsMaj$valenceDiff
t = -1.0233, df = 22, p-value = 0.3173
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.5677389  0.2081325
sample estimates:
       cor 
-0.2131612 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMin$pitchHeight and diffsMin$valenceDiff
t = 0.86122, df = 22, p-value = 0.3984
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.2403101  0.5443349
sample estimates:
      cor 
0.1805934 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMaj$pitchHeight and diffsMaj$valenceDiff
t = -1.715, df = 22, p-value = 0.1004
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.65593466  0.06964085
sample estimates:
      cor 
-0.343403 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">p.adjust</span>(<span class="fu">c</span>(t1<span class="sc">$</span>p.value, t2<span class="sc">$</span>p.value, t3<span class="sc">$</span>p.value, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>           t4<span class="sc">$</span>p.value, t5<span class="sc">$</span>p.value, t6<span class="sc">$</span>p.value)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.15969069 0.03671351 0.18272732 0.63454293 0.63454293 0.30119947</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(t1,t2,t3,t4,t5,t6)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMin<span class="sc">$</span>arPerf, diffsMin<span class="sc">$</span>arousalDiff) <span class="ot">-&gt;</span> t1</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMaj<span class="sc">$</span>arPerf, diffsMaj<span class="sc">$</span>arousalDiff) <span class="ot">-&gt;</span> t2</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMin<span class="sc">$</span>rms, diffsMin<span class="sc">$</span>arousalDiff) <span class="ot">-&gt;</span> t3</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMaj<span class="sc">$</span>rms, diffsMaj<span class="sc">$</span>arousalDiff) <span class="ot">-&gt;</span> t4</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMin<span class="sc">$</span>pitchHeight, diffsMin<span class="sc">$</span>arousalDiff) <span class="ot">-&gt;</span> t5</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(diffsMaj<span class="sc">$</span>pitchHeight, diffsMaj<span class="sc">$</span>arousalDiff) <span class="ot">-&gt;</span> t6</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMin$arPerf and diffsMin$arousalDiff
t = -4.02, df = 22, p-value = 0.0005744
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.8349658 -0.3354137
sample estimates:
       cor 
-0.6507595 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMaj$arPerf and diffsMaj$arousalDiff
t = -3.3373, df = 22, p-value = 0.002985
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.7967980 -0.2301824
sample estimates:
       cor 
-0.5797468 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMin$rms and diffsMin$arousalDiff
t = -5.2507, df = 22, p-value = 2.877e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.8834048 -0.4897002
sample estimates:
       cor 
-0.7457741 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMaj$rms and diffsMaj$arousalDiff
t = -3.0989, df = 22, p-value = 0.005239
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.7809724 -0.1901185
sample estimates:
      cor 
-0.551239 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMin$pitchHeight and diffsMin$arousalDiff
t = 1.7613, df = 22, p-value = 0.09208
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.06041555  0.66118110
sample estimates:
      cor 
0.3515489 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  diffsMaj$pitchHeight and diffsMaj$arousalDiff
t = 1.3209, df = 22, p-value = 0.2001
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1485734  0.6079841
sample estimates:
      cor 
0.2710696 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">p.adjust</span>(<span class="fu">c</span>(t1<span class="sc">$</span>p.value, t2<span class="sc">$</span>p.value, t3<span class="sc">$</span>p.value, </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>           t4<span class="sc">$</span>p.value, t5<span class="sc">$</span>p.value, t6<span class="sc">$</span>p.value), <span class="at">method =</span> <span class="st">'none'</span>), <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00057 0.00299 0.00003 0.00524 0.09208 0.20012</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(t1,t2,t3,t4,t5,t6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(expressiveRatingsAvg<span class="sc">$</span>arousalDiff, expressiveRatingsAvg<span class="sc">$</span>arPerf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  expressiveRatingsAvg$arousalDiff and expressiveRatingsAvg$arPerf
t = -5.06, df = 46, p-value = 7.186e-06
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.7539999 -0.3780759
sample estimates:
       cor 
-0.5979736 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(expressiveRatingsAvg<span class="sc">$</span>arousalDiff, expressiveRatingsAvg<span class="sc">$</span>rms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  expressiveRatingsAvg$arousalDiff and expressiveRatingsAvg$rms
t = -6.0856, df = 46, p-value = 2.155e-07
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.8001448 -0.4735730
sample estimates:
       cor 
-0.6678437 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(expressiveRatingsAvg<span class="sc">$</span>arousalDiff, expressiveRatingsAvg<span class="sc">$</span>pitchHeight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  expressiveRatingsAvg$arousalDiff and expressiveRatingsAvg$pitchHeight
t = 2.3473, df = 46, p-value = 0.02327
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.04731408 0.55922017
sample estimates:
     cor 
0.327052 </code></pre>
</div>
</div>
</section>
<section id="which-cues-predict-differences-in-valence-and-arousal" class="level4">
<h4 class="anchored" data-anchor-id="which-cues-predict-differences-in-valence-and-arousal">Which cues predict differences in valence and arousal?</h4>
<p>Attack rate and RMS significantly predict differences in arousal ratings, whereas pitch height and RMS significantly predict differences in valence ratings</p>
</section>
</section>
</section>
<section id="beta-regression" class="level2">
<h2 class="anchored" data-anchor-id="beta-regression"><strong>Beta Regression</strong></h2>
<p>Perform beta regression to assess significance of differences while dealing with positive (0,1) data:</p>
<p>Create transformation function because data can include 0 and 1 in range:</p>
<p><span class="math display">\[(y * (n -  1) + 0.5)/n\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>arousalDiffB <span class="ot">=</span> <span class="fu">betaTransform</span>(expressiveRatingsAvg<span class="sc">$</span>arousalDiff)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>valenceDiffB <span class="ot">=</span> <span class="fu">betaTransform</span>(expressiveRatingsAvg<span class="sc">$</span>valenceDiff)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># center values of attack rate, rms, pitch height</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg2 <span class="ot">=</span> expressiveRatingsAvg</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg2<span class="sc">$</span>arPerf <span class="ot">=</span> expressiveRatingsAvg<span class="sc">$</span>arPerf <span class="sc">-</span> <span class="fu">mean</span>(expressiveRatingsAvg<span class="sc">$</span>arPerf)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg2<span class="sc">$</span>pitchHeight <span class="ot">=</span> expressiveRatingsAvg<span class="sc">$</span>pitchHeight <span class="sc">-</span> <span class="fu">mean</span>(expressiveRatingsAvg<span class="sc">$</span>pitchHeight)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg2<span class="sc">$</span>rms <span class="ot">=</span> expressiveRatingsAvg<span class="sc">$</span>rms <span class="sc">-</span> <span class="fu">mean</span>(expressiveRatingsAvg<span class="sc">$</span>rms)</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>expressiveRatingsAvg2<span class="sc">$</span>mode <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(expressiveRatingsAvg<span class="sc">$</span>mode)) <span class="sc">-</span> <span class="fl">1.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>bregAro <span class="ot">=</span> <span class="fu">betareg</span>(arousalDiffB <span class="sc">~</span> arPerf <span class="sc">+</span> rms <span class="sc">+</span> </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>          pitchHeight <span class="sc">+</span> mode, <span class="at">data =</span> expressiveRatingsAvg2)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>bregVal <span class="ot">=</span> <span class="fu">betareg</span>(valenceDiffB <span class="sc">~</span> arPerf <span class="sc">+</span> rms <span class="sc">+</span> </span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>      pitchHeight <span class="sc">+</span> mode <span class="sc">+</span> (arPerf<span class="sc">*</span>mode) <span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>      (rms<span class="sc">*</span>mode) <span class="sc">+</span> (pitchHeight<span class="sc">*</span>mode), </span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> expressiveRatingsAvg2)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bregAro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = arousalDiffB ~ arPerf + rms + pitchHeight + mode, data = expressiveRatingsAvg2)

Standardized weighted residuals 2:
    Min      1Q  Median      3Q     Max 
-2.0852 -0.8814  0.3280  0.7495  1.5493 

Coefficients (mean model with logit link):
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.68156    0.10578 -15.897  &lt; 2e-16 ***
arPerf      -0.11196    0.04361  -2.567  0.01025 *  
rms         -0.06953    0.02191  -3.174  0.00151 ** 
pitchHeight  0.04481    0.02407   1.861  0.06271 .  
mode        -0.12270    0.19954  -0.615  0.53860    

Phi coefficients (precision model with identity link):
      Estimate Std. Error z value Pr(&gt;|z|)    
(phi)   14.452      2.974    4.86 1.18e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood: 54.99 on 6 Df
Pseudo R-squared: 0.5459
Number of iterations: 15 (BFGS) + 4 (Fisher scoring) </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bregVal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
betareg(formula = valenceDiffB ~ arPerf + rms + pitchHeight + mode + 
    (arPerf * mode) + (rms * mode) + (pitchHeight * mode), data = expressiveRatingsAvg2)

Standardized weighted residuals 2:
    Min      1Q  Median      3Q     Max 
-1.9831 -0.5145 -0.2374  0.8197  2.2378 

Coefficients (mean model with logit link):
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      -2.439136   0.084534 -28.854  &lt; 2e-16 ***
arPerf           -0.011119   0.034075  -0.326  0.74420    
rms               0.008926   0.018879   0.473  0.63636    
pitchHeight      -0.011226   0.019323  -0.581  0.56127    
mode              0.508362   0.160029   3.177  0.00149 ** 
arPerf:mode       0.207996   0.068318   3.045  0.00233 ** 
rms:mode          0.036708   0.037769   0.972  0.33110    
pitchHeight:mode  0.111812   0.038733   2.887  0.00389 ** 

Phi coefficients (precision model with identity link):
      Estimate Std. Error z value Pr(&gt;|z|)    
(phi)   44.843      9.311   4.816 1.46e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Type of estimator: ML (maximum likelihood)
Log-likelihood: 92.86 on 9 Df
Pseudo R-squared: 0.4849
Number of iterations: 20 (BFGS) + 2 (Fisher scoring) </code></pre>
</div>
</div>
<section id="which-pieces-significantly-differ" class="level4">
<h4 class="anchored" data-anchor-id="which-pieces-significantly-differ">Which pieces significantly differ?</h4>
<p>Next we employ a bootstrap approach to assess how many pieces significantly differed in valence and arousal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first, prepare data. Need 48 unique piece IDs</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>fullDat<span class="sc">$</span>pieceID <span class="ot">=</span> <span class="fu">paste0</span>(fullDat<span class="sc">$</span>pieceID,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">substr</span>(fullDat<span class="sc">$</span>composer, <span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(1)</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrapCircumplexDifference(</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                  subset(fullDat, condition == 'expressive'),</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                  subset(fullDat, condition == 'deadpan'),</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                  returnSummary = F, replications = 10000,</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                  sampleSize = 30,</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                  xlimsVal = c(-1.5,1.5),</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                  xlimsAro = c(-1.5,1.5),</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ylimsVal = c(-1.5,1.5),</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ylimsAro = c(-1.5,1.5), scaleVars = F) -&gt; bootData</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co"># save(bootData, file = '~/Bootstrap.RData')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="coefficients-of-variation" class="level1">
<h1>Coefficients of Variation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="st">'Expressive'</span>, <span class="st">'Deadpan'</span>),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">meanCVVal =</span> <span class="fu">c</span>(<span class="fu">mean</span>(bootData<span class="sc">$</span>valenceA_cv), <span class="fu">mean</span>(bootData<span class="sc">$</span>valenceB_cv)),</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lciCVVal =</span> <span class="fu">c</span>(<span class="fu">quantile</span>(bootData<span class="sc">$</span>valenceA_cv, <span class="fu">c</span>(<span class="fl">0.025</span>)),</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">quantile</span>(bootData<span class="sc">$</span>valenceB_cv, <span class="fu">c</span>(<span class="fl">0.025</span>))),</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">uciCVVal =</span> <span class="fu">c</span>(<span class="fu">quantile</span>(bootData<span class="sc">$</span>valenceA_cv, <span class="fu">c</span>(<span class="fl">0.975</span>)),</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">quantile</span>(bootData<span class="sc">$</span>valenceB_cv, <span class="fu">c</span>(<span class="fl">0.975</span>))),</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">meanCVAro =</span> <span class="fu">c</span>(<span class="fu">mean</span>(bootData<span class="sc">$</span>arousalA_cv),<span class="fu">mean</span>(bootData<span class="sc">$</span>arousalB_cv)),</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">lciCVAro =</span> <span class="fu">c</span>(<span class="fu">quantile</span>(bootData<span class="sc">$</span>arousalA_cv, <span class="fu">c</span>(<span class="fl">0.025</span>)),</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">quantile</span>(bootData<span class="sc">$</span>arousalB_cv, <span class="fu">c</span>(<span class="fl">0.025</span>))),</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">uciCVAro =</span> <span class="fu">c</span>(<span class="fu">quantile</span>(bootData<span class="sc">$</span>arousalA_cv, <span class="fu">c</span>(<span class="fl">0.975</span>)),</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">quantile</span>(bootData<span class="sc">$</span>arousalB_cv, <span class="fu">c</span>(<span class="fl">0.975</span>)))</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>) <span class="ot">-&gt;</span> expressCVSig</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(expressCVSig, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> meanCVVal<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymin =</span> lciCVVal<span class="sc">*</span><span class="dv">100</span>, <span class="at">ymax =</span> uciCVVal<span class="sc">*</span><span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span> <span class="fu">geom_errorbar</span>()<span class="sc">+</span><span class="fu">ylim</span>(<span class="dv">20</span>, <span class="dv">50</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Coefficient of Variation (%)'</span>, <span class="at">x =</span> <span class="st">'Condition'</span>, <span class="at">subtitle=</span><span class="st">'Valence'</span>)<span class="sc">+</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(expressCVSig, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> meanCVAro<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymin =</span> lciCVAro<span class="sc">*</span><span class="dv">100</span>, <span class="at">ymax =</span> uciCVAro<span class="sc">*</span><span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span> <span class="fu">geom_errorbar</span>()<span class="sc">+</span><span class="fu">ylim</span>(<span class="dv">20</span>,<span class="dv">50</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">''</span>, <span class="at">x =</span> <span class="st">'Condition'</span>, <span class="at">subtitle=</span><span class="st">'Arousal'</span>)<span class="sc">+</span></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#ggsave(filename = paste0('Figures/Fig 4-', Sys.Date(), '.png'))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(expressCVSig,<span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">as.numeric</span>(x)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     group meanCVVal lciCVVal uciCVVal meanCVAro lciCVAro uciCVAro
[1,]    NA   29.2690  27.9298  30.6597   43.1718  41.6172  44.7738
[2,]    NA   28.9314  27.6538  30.2424   34.6069  32.9538  36.2531</code></pre>
</div>
</div>
</section>
<section id="plot-differences" class="level1">
<h1>Plot differences</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>key <span class="ot">&lt;-</span> <span class="fu">nameKeysSimple</span>(<span class="fu">substr</span>(bootPlotDF<span class="sc">$</span>pieceID, <span class="dv">1</span>, <span class="fu">nchar</span>(bootPlotDF<span class="sc">$</span>pieceID)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>composer <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">substr</span>(bootPlotDF<span class="sc">$</span>pieceID,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">nchar</span>(bootPlotDF<span class="sc">$</span>pieceID),</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">nchar</span>(bootPlotDF<span class="sc">$</span>pieceID)))</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(bootPlotDF<span class="sc">$</span>composer) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'bach'</span>, <span class="st">'chopin'</span>)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co"># temporarily change key back to a character vector to replace c# value with db</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>key <span class="ot">=</span> <span class="fu">as.character</span>(bootPlotDF<span class="sc">$</span>key)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>key[bootPlotDF<span class="sc">$</span>composer <span class="sc">==</span> <span class="st">'chopin'</span> <span class="sc">&amp;</span> </span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>             bootPlotDF<span class="sc">$</span>key <span class="sc">==</span> <span class="st">'C#'</span>] <span class="ot">&lt;-</span> <span class="st">'Db'</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="co"># now convert back to factor</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>key <span class="ot">=</span> <span class="fu">as.factor</span>(bootPlotDF<span class="sc">$</span>key)</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>key <span class="ot">=</span> <span class="fu">prettyKeyCol</span>(bootPlotDF<span class="sc">$</span>key)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>sigDifValence <span class="ot">=</span> <span class="fu">sign</span>(bootPlotDF<span class="sc">$</span>changeValenceLCI) <span class="sc">==</span> <span class="fu">sign</span>(bootPlotDF<span class="sc">$</span>changeValenceUCI)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>bootPlotDF<span class="sc">$</span>sigDifArousal <span class="ot">=</span> <span class="fu">sign</span>(bootPlotDF<span class="sc">$</span>changeArousalLCI) <span class="sc">==</span> <span class="fu">sign</span>(bootPlotDF<span class="sc">$</span>changeArousalUCI)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bootPlotDF<span class="sc">$</span>sigDifArousal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mode   FALSE    TRUE 
logical      28      20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bootPlotDF<span class="sc">$</span>sigDifValence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mode   FALSE    TRUE 
logical      45       3 </code></pre>
</div>
</div>
<ul>
<li><p>20 pieces significantly differed in arousal, 13 of which were by Bach</p></li>
<li><p>3 pieces differed significantly in valence</p></li>
</ul>
<p>Note: Bach and Chopin wrote G# as key sig in minor keys, but Ab in major keys; Chopin wrote in Db minor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change dimensions for easy visualization</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>summaryDat[,<span class="sc">!</span><span class="fu">colnames</span>(summaryDat) <span class="sc">==</span> <span class="st">'albumID'</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">'condition'</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">'valence'</span>, <span class="st">'arousal'</span>)) <span class="ot">-&gt;</span> wideDat</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>wideDat<span class="sc">$</span>mode <span class="ot">&lt;-</span> <span class="fu">factor</span>(wideDat<span class="sc">$</span>key <span class="sc">==</span> <span class="fu">tolower</span>(wideDat<span class="sc">$</span>key))</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(wideDat<span class="sc">$</span>mode) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Major'</span>, <span class="st">'minor'</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show ids where difference is significant</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>corrSigPlot <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(thisComposer <span class="cf">in</span> <span class="fu">c</span>(<span class="st">'bach'</span>, <span class="st">'chopin'</span>)) {</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset by composer</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>  wideDatSS <span class="ot">=</span> <span class="fu">subset</span>(wideDat, composer <span class="sc">==</span> thisComposer) </span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># subset bootstrap simulations</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>  bootPlotSS <span class="ot">=</span> <span class="fu">subset</span>(bootPlotDF, composer <span class="sc">==</span> thisComposer)</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check which keys yield sig difference in bootplot</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>  wideDatSS<span class="sc">$</span>labelsValence <span class="ot">=</span> wideDatSS<span class="sc">$</span>key <span class="sc">%in%</span> bootPlotSS<span class="sc">$</span>key[bootPlotSS<span class="sc">$</span>sigDifValence <span class="sc">==</span> T]</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>  wideDatSS<span class="sc">$</span>labelsArousal <span class="ot">=</span> wideDatSS<span class="sc">$</span>key <span class="sc">%in%</span> bootPlotSS<span class="sc">$</span>key[bootPlotSS<span class="sc">$</span>sigDifArousal <span class="sc">==</span> T]</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bind to data frame</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>  corrSigPlot <span class="ot">&lt;-</span> <span class="fu">rbind</span>(corrSigPlot, wideDatSS)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a><span class="co"># hide non-significant key signatures for valence and change mode colour to grey</span></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>corrSigPlot<span class="sc">$</span>key2 <span class="ot">=</span> corrSigPlot<span class="sc">$</span>key</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>corrSigPlot<span class="sc">$</span>key2[<span class="sc">!</span>corrSigPlot<span class="sc">$</span>labelsValence] <span class="ot">=</span> <span class="st">''</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>corrSigPlot<span class="sc">$</span>mode2 <span class="ot">=</span> corrSigPlot<span class="sc">$</span>mode</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(corrSigPlot<span class="sc">$</span>mode2[<span class="sc">!</span>corrSigPlot<span class="sc">$</span>labelsValence]) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'*'</span>, <span class="st">'*'</span>)</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>corrSigPlot<span class="sc">$</span>key3 <span class="ot">=</span> corrSigPlot<span class="sc">$</span>key</span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>corrSigPlot<span class="sc">$</span>key3[<span class="sc">!</span>corrSigPlot<span class="sc">$</span>labelsArousal] <span class="ot">=</span> <span class="st">''</span></span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>corrSigPlot<span class="sc">$</span>mode3 <span class="ot">=</span> corrSigPlot<span class="sc">$</span>mode</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(corrSigPlot<span class="sc">$</span>mode3[<span class="sc">!</span>corrSigPlot<span class="sc">$</span>labelsArousal]) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'*'</span>, <span class="st">'*'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now plot figures:</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>corrSigPlot <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> valence_deadpan, <span class="at">y =</span> valence_expressive, <span class="at">label =</span> key2, <span class="at">alpha =</span> mode2)) <span class="sc">+</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="at">linetype =</span> <span class="dv">1</span>,<span class="at">color =</span> <span class="st">'grey50'</span>, <span class="at">se =</span> F, <span class="at">alpha =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">'grey'</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">'grey'</span>,<span class="fu">aes</span>(<span class="at">shape =</span> composer, <span class="at">color =</span> mode2, <span class="at">alpha =</span> mode2))<span class="sc">+</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(corrSigPlot, <span class="sc">!</span><span class="fu">is.na</span>(corrSigPlot<span class="sc">$</span>mode2)), </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">shape =</span> composer, <span class="at">color =</span> mode2, <span class="at">alpha =</span> mode2))<span class="sc">+</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">color =</span> mode2, <span class="at">alpha =</span> mode2), <span class="at">max.overlaps =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stat_cor(method="pearson", r.digits = 5, p.accuracy =  0.01)+</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'firebrick1'</span>, <span class="st">'dodgerblue2'</span>))<span class="sc">+</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Deadpan Rating'</span>,<span class="at">y=</span><span class="st">'Expressive Rating'</span>)<span class="sc">+</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Valence'</span>) <span class="sc">+</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cc1</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>corrSigPlot <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> arousal_deadpan, <span class="at">y =</span> arousal_expressive, <span class="at">label =</span> key3,</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">alpha =</span> mode3)) <span class="sc">+</span>  </span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,<span class="at">linetype =</span> <span class="dv">1</span>,<span class="at">color =</span> <span class="st">'grey50'</span>, <span class="at">se =</span> F, <span class="at">alpha =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">'grey'</span>, <span class="at">linetype =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">'grey'</span>, <span class="fu">aes</span>(<span class="at">shape =</span> composer, <span class="at">color =</span> mode3, <span class="at">alpha =</span> mode3))<span class="sc">+</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(corrSigPlot, <span class="sc">!</span><span class="fu">is.na</span>(corrSigPlot<span class="sc">$</span>mode3)), <span class="fu">aes</span>(<span class="at">shape =</span> composer, <span class="at">color =</span> mode3, <span class="at">alpha =</span> mode3))<span class="sc">+</span></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">color =</span> mode3, <span class="at">alpha =</span> mode3), <span class="at">max.overlaps =</span> <span class="dv">15</span>, <span class="at">nudge_y =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#stat_cor(method="pearson", r.digits = 5, p.accuracy = 0.01)+</span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'firebrick1'</span>, <span class="st">'dodgerblue2'</span>))<span class="sc">+</span></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">'right'</span>)<span class="sc">+</span></span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Deadpan Rating'</span>,<span class="at">y=</span><span class="st">'Expressive Rating'</span>)<span class="sc">+</span></span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Arousal'</span>) <span class="sc">+</span></span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>) <span class="ot">-&gt;</span> cc2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># layout figures...</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>cc1<span class="ot">&lt;-</span>cc1<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">1</span>,<span class="dv">7</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">7</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Deadpan Rating'</span>,<span class="at">y=</span><span class="st">'Expressive Rating'</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>cc2<span class="ot">&lt;-</span>cc2<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">1</span>,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="dv">1</span>,<span class="dv">100</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Deadpan Rating'</span>,<span class="at">y=</span><span class="st">'Expressive Rating'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for y is already present.
Adding another scale for y, which will replace the existing scale.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(correlationLegend,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>             cc1,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>             bs1<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>             cc2,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>             bs2<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">layout_matrix =</span> corrSigLayout) <span class="ot">-&gt;</span> all_corr_plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(paste0('Figures/Fig 3-', Sys.Date(), '.png'), plot = all_corr_plots,</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       height = 5, width = 12.5, units = 'in')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="supplemental-analyses" class="level4">
<h4 class="anchored" data-anchor-id="supplemental-analyses">Supplemental Analyses</h4>
<ul>
<li><p>This analyses how uncentered estimates contributed to multicollinearity with mode</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert mode to numeric variable for point-biserial correlation: </span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(expressiveRatingsAvg<span class="sc">$</span>mode))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define uncentered pitch height </span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> expressiveRatingsAvg<span class="sc">$</span>pitchHeight </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define uncentered attack rate </span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>w <span class="ot">=</span> expressiveRatingsAvg<span class="sc">$</span>arPerf </span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define interaction between mode and uncentered pitch height </span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>xz <span class="ot">=</span> x<span class="sc">*</span>z </span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co"># define interaction between mode and uncentered attack rate </span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>xw <span class="ot">=</span> x<span class="sc">*</span>w</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co"># define mean-centered pitch height</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>z_c <span class="ot">=</span>  z <span class="sc">-</span> <span class="fu">mean</span>(z) </span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co"># define mean-centered attack rate </span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>w_c <span class="ot">=</span> w <span class="sc">-</span> <span class="fu">mean</span>(w) </span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="co"># define interaction between mean-centered mode and pitch height </span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>xz_c <span class="ot">=</span> x<span class="sc">*</span>z_c </span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co"># define interaction between mean-centered mode and attack rate</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>xw_c <span class="ot">=</span> x<span class="sc">*</span>w_c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot each relation between mode and interaction terms </span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCorrelation</span>(x, xz, <span class="at">xLab =</span> <span class="st">'Mode'</span>, <span class="at">yLab =</span> <span class="st">'Mode x </span><span class="sc">\n</span><span class="st">(Uncentered) Pitch Height'</span>)<span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Uncentered Pitch Height'</span>)<span class="sc">+</span> </span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCorrelation</span>(x, xz_c, <span class="at">xLab =</span> <span class="st">'Mode'</span>, <span class="at">yLab =</span> <span class="st">'Mode x </span><span class="sc">\n</span><span class="st">(Centered) Pitch Height'</span>)<span class="sc">+</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Mean-Centered Pitch Height'</span>)<span class="sc">+</span> </span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCorrelation</span>(x, xw, <span class="at">xLab =</span> <span class="st">'Mode'</span>, <span class="at">yLab =</span> <span class="st">'Mode x </span><span class="sc">\n</span><span class="st">(Uncentered) Attack Rate'</span>)<span class="sc">+</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Uncentered Attack Rate'</span>)<span class="sc">+</span> </span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCorrelation</span>(x, xw_c, <span class="at">xLab =</span> <span class="st">'Mode'</span>, <span class="at">yLab =</span> <span class="st">'Mode x </span><span class="sc">\n</span><span class="st">(Centered) Pitch Height'</span>)<span class="sc">+</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Mean-Centered Attack Rate'</span>)<span class="sc">+</span>   </span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_annotation</span>(<span class="at">subtitle =</span> <span class="st">"Relation between mode's main effect and uncentred </span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="st">                (left) vs. centred (right) interaction terms"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave('Figures/SupplementalFig.png')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Correlation between mode and (i) mode x pitch height interaction term (top); (ii) mode x attack rate interaction term (bottom). Left: pitch height and attack rate uncentered; right: pitch height and attack rate centered at respective mean value.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>